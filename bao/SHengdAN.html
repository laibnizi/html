<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<style type="text/css">
			/*body {
				background: url(img/312.jpg);
				background-repeat: no-repeat;
				background-size: 100%;
				width: 100%;
				height: 100%;
			}
			
			.pro {
				margin-left: 50%;
			}
		</style>
		
		
		<style type="text/css">
		body {
			background-color: #000044;
			background:url(img/312.jpg) repeat-x;
			background-size: 100%;
			margin: 0px;
			overflow: hidden;
		}
		
		a {
			color: #0078ff;
		}
		.pro {
				margin-left: 50%;
			}
	</style>
	
	
	<script type="text/javascript" src="js/ThreeCanvas.js"></script>
	<script type="text/javascript" src="js/Snow.js"></script>
	<script type="text/javascript">
		var SCREEN_WIDTH = window.innerWidth;
		var SCREEN_HEIGHT = window.innerHeight;

		var container;

		var particle;

		var camera;
		var scene;
		var renderer;

		var mouseX = 0;
		var mouseY = 0;

		var windowHalfX = window.innerWidth / 2;
		var windowHalfY = window.innerHeight / 2;

		var particles = [];
		var particleImage = new Image(); //THREE.ImageUtils.loadTexture( "img/ParticleSmoke.png" );
		particleImage.src = 'img/ParticleSmoke.png';

		function init() {

			container = document.createElement('div');
			document.body.appendChild(container);

			camera = new THREE.PerspectiveCamera(75, SCREEN_WIDTH / SCREEN_HEIGHT, 1, 10000);
			camera.position.z = 1000;

			scene = new THREE.Scene();
			scene.add(camera);

			renderer = new THREE.CanvasRenderer();
			renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
			var material = new THREE.ParticleBasicMaterial({
				map: new THREE.Texture(particleImage)
			});

			for(var i = 0; i < 500; i++) {

				particle = new Particle3D(material);
				particle.position.x = Math.random() * 2000 - 1000;
				particle.position.y = Math.random() * 2000 - 1000;
				particle.position.z = Math.random() * 2000 - 1000;
				particle.scale.x = particle.scale.y = 1;
				scene.add(particle);

				particles.push(particle);
			}

			container.appendChild(renderer.domElement);

			document.addEventListener('mousemove', onDocumentMouseMove, false);
			document.addEventListener('touchstart', onDocumentTouchStart, false);
			document.addEventListener('touchmove', onDocumentTouchMove, false);

			setInterval(loop, 1000 / 60);

		}

		function onDocumentMouseMove(event) {

			mouseX = event.clientX - windowHalfX;
			mouseY = event.clientY - windowHalfY;
		}

		function onDocumentTouchStart(event) {

			if(event.touches.length == 1) {

				event.preventDefault();

				mouseX = event.touches[0].pageX - windowHalfX;
				mouseY = event.touches[0].pageY - windowHalfY;
			}
		}

		function onDocumentTouchMove(event) {

			if(event.touches.length == 1) {

				event.preventDefault();

				mouseX = event.touches[0].pageX - windowHalfX;
				mouseY = event.touches[0].pageY - windowHalfY;
			}
		}

		//

		function loop() {

			for(var i = 0; i < particles.length; i++) {

				var particle = particles[i];
				particle.updatePhysics();

				with(particle.position) {
					if(y < -1000) y += 2000;
					if(x > 1000) x -= 2000;
					else if(x < -1000) x += 2000;
					if(z > 1000) z -= 2000;
					else if(z < -1000) z += 2000;
				}
			}

			camera.position.x += (mouseX - camera.position.x) * 0.05;
			camera.position.y += (-mouseY - camera.position.y) * 0.05;
			camera.lookAt(scene.position);

			renderer.render(scene, camera);

		}
	</script>

		
	</head>

	<body  onload="init()">

		<a href="demo.html">

			<div class="pro">

				<canvas id="c"></canvas>
				<script>
					var b = document.body;
					var c = document.getElementsByTagName('canvas')[0];
					var a = c.getContext('2d');
					document.body.clientWidth; // fix bug in chrome.
				</script>
				<script>
					// start of submission //
					M = Math;
					Q = M.random;
					J = [];
					U = 16;
					T = M.sin;
					E = M.sqrt;
					for(O = k = 0; x = z = j = i = k < 200;)
						with(M[k] = k ? c.cloneNode(0) : c) {
							width = height = k ? 32 : W = 446;
							with(getContext('2d')) if(k > 10 | !k)
									for(font = '60px Impact', V = 'rgba('; I = i * U, fillStyle = k ? k == 13 ? V + '205,205,215,.15)' : V + (147 + I) + ',' + (k % 2 ? 128 + I : 0) + ',' + I + ',.5)' : '%23cca', i < 7;) beginPath(fill(arc(U - i / 3, 24 - i / 2, k == 13 ? 4 - (i++) / 2 : 8 - i++, 0, M.PI * 2, 1)));
								else
									for(; x = T(i), y = Q() * 2 - 1, D = x * x + y * y, B = E(D - x / .9 - 1.5 * y + 1), R = 67 * (B + 1) * (L = k / 9 + .8) >> 1, i++ < W;)
										if(D < 1) beginPath(strokeStyle = V + R + ',' + (R + B * L >> 0) + ',40,.1)'), moveTo(U + x * 8, U + y * 8), lineTo(U + x * U, U + y * U), stroke();
							for(y = H = k + E(k++) * 25, R = Q() * W; P = 3, j < H;) J[O++] = [x += T(R) * P + Q() * 6 - 3, y += Q() * U - 8, z += T(R - 11) * P + Q() * 6 - 3, j / H * 20 + ((j += U) > H & Q() > .8 ? Q(P = 9) * 4 : 0) >> 1]
						}
					setInterval(function G(m, l) {
						A = T(D - 11);
						if(l) return(m[2] - l[2]) * A + (l[0] - m[0]) * T(D);
						a.clearRect(0, 0, W, W);
						J.sort(G);
						for(i = 0; L = J[i++]; a.drawImage(M[L[3] + 1], 207 + L[0] * A + L[2] * T(D) >> 0, L[1] >> 1)) {
							if(i == 2e3) a.fillText('Merry Xmas!', U, 345);
							if(!(i % 7)) a.drawImage(M[13], ((157 * (i * i) + T(D * 5 + i * i) * 5) % W) >> 0, ((113 * i + (D * i) / 60) % (290 + i / 99)) >> 0);
						}
						D += .02
					}, 1)
					// end of submission //
				</script>

			</div>

		</a>
	</body>

</html>